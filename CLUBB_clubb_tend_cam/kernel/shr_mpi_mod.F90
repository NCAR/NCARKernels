!KGEN-generated Fortran source file 
  
!Generated at : 2016-06-15 08:50:04 
!KGEN version : 0.7.0 
  
!===============================================================================
! SVN $Id: shr_mpi_mod.F90 65839 2014-11-30 14:40:15Z jedwards $
! SVN $URL: https://svn-ccsm-models.cgd.ucar.edu/csm_share/trunk_tags/share3_150116/shr/shr_mpi_mod.F90 $
!===============================================================================

Module shr_mpi_mod

!-------------------------------------------------------------------------------
! PURPOSE: general layer on MPI functions
!-------------------------------------------------------------------------------

    USE shr_kind_mod 
    USE shr_log_mod, ONLY: s_logunit => shr_log_unit 

    USE kgen_utils_mod, ONLY: kgen_dp, kgen_array_sumcheck 
    IMPLICIT NONE 
    PRIVATE 

! PUBLIC: Public interfaces

    PUBLIC shr_mpi_chkerr 
    PUBLIC shr_mpi_initialized 
    PUBLIC shr_mpi_abort 












!      
!      
!      (C) 2001 by Argonne National Laboratory.
!      See COPYRIGHT in top-level directory.
!      
!      DO NOT EDIT
!      This file created by buildiface 
!      
       INTEGER MPI_SUCCESS
       PARAMETER (mpi_success=0) 
       INTEGER MPI_MAX_ERROR_STRING
       PARAMETER (mpi_max_error_string=512-1) 



!===============================================================================
CONTAINS
!===============================================================================

SUBROUTINE shr_mpi_chkerr(rcode,string)

   IMPLICIT none

   !----- arguments ---
   integer(SHR_KIND_IN), intent(in) :: rcode  ! input MPI error code
   character(*),         intent(in) :: string ! message

   !----- local ---
   character(*),parameter           :: subName = '(shr_mpi_chkerr) '
   character(MPI_MAX_ERROR_STRING)  :: lstring
   integer(SHR_KIND_IN)             :: len
   integer(SHR_KIND_IN)             :: ierr

!-------------------------------------------------------------------------------
! PURPOSE: layer on MPI error checking
!-------------------------------------------------------------------------------

   if (rcode /= MPI_SUCCESS) then
     write(s_logunit,*) trim(subName),":",lstring(1:len)
     call shr_mpi_abort(string,rcode)
   endif

END SUBROUTINE shr_mpi_chkerr

!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================







!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================







!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================








!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================




!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================






!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================

SUBROUTINE shr_mpi_initialized(flag,string)

   IMPLICIT none

   !----- arguments ---
   logical,intent(out)                :: flag
   character(*),optional,intent(in)   :: string   ! message

   !----- local ---
   character(*),parameter             :: subName = '(shr_mpi_initialized) '
   integer(SHR_KIND_IN)               :: ierr

!-------------------------------------------------------------------------------
! PURPOSE: MPI initialized
!-------------------------------------------------------------------------------

   if (present(string)) then
     call shr_mpi_chkerr(ierr,subName//trim(string))
   else
     call shr_mpi_chkerr(ierr,subName)
   endif

END SUBROUTINE shr_mpi_initialized

!===============================================================================
!===============================================================================

SUBROUTINE shr_mpi_abort(string,rcode)

   IMPLICIT none

   !----- arguments ---
   character(*),optional,intent(in)   :: string   ! message
   integer,optional,intent(in)        :: rcode    ! optional code

   !----- local ---
   character(*),parameter             :: subName = '(shr_mpi_abort) '
   integer(SHR_KIND_IN)               :: ierr
   integer                            :: rc       ! return code

!-------------------------------------------------------------------------------
! PURPOSE: MPI abort
!-------------------------------------------------------------------------------

   if ( present(string) .and. present(rcode) ) then
      write(s_logunit,*) trim(subName),":",trim(string),rcode
   endif
   if ( present(rcode) )then
      rc = rcode
   else
      rc = 1001
   end if

END SUBROUTINE shr_mpi_abort

!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================



!===============================================================================
!===============================================================================

END MODULE shr_mpi_mod