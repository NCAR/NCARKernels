!KGEN-generated Fortran source file 
  
!Generated at : 2019-06-20 14:46:40 
!KGEN version : 0.8.1 
  


module time_manager
! Provide CAM specific time management.  This is a wrapper layer for the ESMF
! time manager utility.


    USE esmf 

    USE kgen_utils_mod, ONLY: kgen_dp, kgen_array_sumcheck 
    USE tprof_mod, ONLY: tstart, tstop, tnull, tprnt 

    IMPLICIT NONE 
    PRIVATE 
    SAVE 
! Public methods


    PUBLIC get_nstep 
! Private module data


! The target attribute for tm_cal is needed (at least by NAG) because there are
! pointers to this object inside ESMF_Time objects.

type(ESMF_Clock)            :: tm_clock      ! Model clock   
!=========================================================================================
PUBLIC kr_externs_in_time_manager 
PUBLIC kr_externs_out_time_manager 

contains
!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================

integer function get_nstep()
! Return the timestep number.
! Local variables


   character(len=*), parameter :: sub = 'get_nstep'
   integer :: rc
   integer(ESMF_KIND_I8) :: step_no
!-----------------------------------------------------------------------------------------

   call ESMF_ClockGet(tm_clock, advanceCount=step_no, rc=rc)
   call chkrc(rc, sub//': error return from ESMF_ClockGet')
   get_nstep = step_no

end function get_nstep
!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================
 

!=========================================================================================
 

!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


!=========================================================================================


subroutine chkrc(rc, mes)
   integer, intent(in)          :: rc   ! return code from time management library
   character(len=*), intent(in) :: mes  ! error message
   if ( rc == ESMF_SUCCESS ) return
end subroutine chkrc

!read state subroutine for kr_externs_in_time_manager 
SUBROUTINE kr_externs_in_time_manager(kgen_unit) 
    INTEGER, INTENT(IN) :: kgen_unit 
    LOGICAL :: kgen_istrue 
    REAL(KIND=8) :: kgen_array_sum 
      
    CALL kr_esmf_clockmod_esmf_clock(tm_clock, kgen_unit, "tm_clock", .FALSE.) 
END SUBROUTINE kr_externs_in_time_manager 
  
!read state subroutine for kr_externs_out_time_manager 
SUBROUTINE kr_externs_out_time_manager(kgen_unit) 
    INTEGER, INTENT(IN) :: kgen_unit 
      
    LOGICAL :: kgen_istrue 
    REAL(KIND=8) :: kgen_array_sum 
END SUBROUTINE kr_externs_out_time_manager 
  
end module time_manager